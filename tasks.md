# 実装タスク一覧

※ フェーズ1〜6が対人対戦MVPの完成ライン、フェーズ7以降はポストMVP拡張。

## フェーズ1: プロジェクト初期設定
- [x] Phoenix + LiveView プロジェクトの新規作成 (`mix phx.new .`)
- [x] `.formatter.exs` と `mix.exs` の設定調整（Elixir バージョン、依存関係の確認）
- [x] `mix phx.gen.secret` で生成したシークレットの環境変数化
- [x] 開発用 `config/dev.exs` に LiveView デバッグ/コードリロード設定を追記
- [x] GitHub Actions など CI 用ワークフローの雛形追加（`mix format --check-formatted` と `mix test`）

## フェーズ2: ドメイン設計と基盤
- [x] 将棋盤・駒・手番・対局状態を表すドメインモデルの設計メモ作成
- [x] `ToukonAiShogi.Game` コンテキスト作成（局面管理、合法手検証は後回し）
- [x] 駒画像を Phoenix の静的ファイル（`priv/static/images/koma/`）へ配置・参照設定
- [x] 初期盤面を JSON/構造体で保持するモジュールの実装
- [x] 「リクエスト」判定のフロー仕様を文書化（後続実装の基準）

## フェーズ3: LiveView UI 基盤
- [ ] `ToukonAiShogiWeb.BoardLive` の雛形実装（マウント時に初期盤面を描画）
- [ ] 将棋盤 UI コンポーネント化（9x9 グリッド、ドラッグ＆ドロップのスタブ）
- [ ] 手番表示・対局ステータスを LiveComponent で切り出し
- [ ] 駒操作イベント（クリック→ドラッグ→ドロップ）を LiveView イベントとして受け取るスタブを実装
- [ ] Tailwind などスタイル設定の導入可否を決定し、必要ならセットアップ

## フェーズ4: 対局ロジック（縁台ルール対応）
- [ ] 任意移動を許容する駒移動処理（行き先バリデーションなし）
- [ ] 「成／不成」の選択ダイアログと状態反映
- [ ] 「参りました」アクションの実装（対局終了・勝者表示）
- [ ] 「リクエスト」ボタンの実装と結果ダイアログ（判定ロジックは仮実装でも可）
- [ ] 相手3段目突入時の自動プロンプト処理

## フェーズ5: 対人対戦機能仕上げ
- [ ] `mix phx.gen.auth` を用いたアカウント登録・ログイン機能導入
- [ ] ロビー LiveView を実装し、入室プレイヤー一覧を表示
- [ ] 2 人揃った時点で対局部屋を生成するマッチングロジック
- [ ] Phoenix.PubSub を使った対局状態のブロードキャスト共有
- [ ] Presence もしくはセッション管理による参加者トラッキングと再接続処理
- [ ] 対局結果の永続化テーブル設計（勝敗記録の保存）
- [ ] 将来的なレーティング算出用フィールドをスキーマに準備

## フェーズ6: MVP 品質担保
- [ ] ドメインモジュールの ExUnit テスト（初期盤面、対局ステータス遷移）
- [ ] LiveView インタラクションのテスト（`Phoenix.LiveViewTest`）
- [ ] テストデータファクトリ（`ExMachina` など）導入検討
- [ ] `mix test --cover` でカバレッジ確認と閾値設定
- [ ] CI での自動テスト実行確認
- [ ] 棋譜保存のMVP実装（各対局が終了後に指し手リストを JSON などで保存）

## フェーズ7: ポストMVP拡張
- [ ] 棋譜保存フォーマットの検討（PGN / CSA / KIF などの比較と採用方針）
- [ ] コンピュータ対戦のための AI インターフェース設計
- [ ] 「入玉宣言法」対応ロジックの設計メモ作成
- [ ] ド派手な演出用アニメーション方針の検討
